---
/**
 * LandingLayout
 *
 * Optimized layout for lead generation landing pages.
 * Includes Header, Footer, MobileMenu, and MobileCtaBar slots.
 *
 * @example
 * <LandingLayout
 *   title="Lakásköltöztetés Budapest"
 *   description="Professzionális lakásköltöztetés..."
 *   header={{
 *     logo: { src: '/logo.svg', alt: 'Költöztető Kft.' },
 *     phone: '+36 1 234 5678',
 *     ctaText: 'Árajánlat',
 *     ctaHref: '#contact',
 *     navItems: [...],
 *   }}
 *   footer={{
 *     companyName: 'Költöztető Kft.',
 *     phone: '+36 1 234 5678',
 *     ...
 *   }}
 *   mobileMenu={{ ... }}
 *   mobileCta={{
 *     phone: '+36 1 234 5678',
 *     ctaText: 'Árkalkulátor',
 *     ctaHref: '#calculator',
 *   }}
 * >
 *   <section>Hero section</section>
 *   <section>Features</section>
 *   <section>Form</section>
 * </LandingLayout>
 */

import BaseLayout from './BaseLayout.astro';
import type { Props as BaseProps } from './BaseLayout.astro';

// Import component types (these would come from @leadgen/components in real usage)
export interface LogoConfig {
  src: string;
  alt: string;
  width?: number;
  height?: number;
}

export interface NavItem {
  label: string;
  href: string;
  children?: NavItem[];
}

export interface HeaderConfig {
  logo: LogoConfig;
  navItems?: NavItem[];
  phone: string;
  address?: string;
  ctaText: string;
  ctaHref: string;
}

export interface FooterColumn {
  title: string;
  links: Array<{ label: string; href: string }>;
}

export interface SocialLink {
  platform: 'facebook' | 'instagram' | 'linkedin' | 'youtube' | 'tiktok' | 'twitter';
  href: string;
}

export interface OpeningHours {
  days: string;
  hours: string;
  schemaDays?: string;
  schemaTime?: string;
}

export interface FooterConfig {
  companyName: string;
  companyInfo?: string;
  logo?: string;
  address?: string;
  phone?: string;
  email?: string;
  columns?: FooterColumn[];
  legalLinks?: Array<{ label: string; href: string }>;
  socialLinks?: SocialLink[];
  openingHours?: OpeningHours[];
}

export interface MobileMenuConfig {
  logo: LogoConfig;
  phone?: string;
  navItems?: NavItem[];
  ctaText?: string;
  ctaHref?: string;
}

export interface MobileCtaConfig {
  phone: string;
  phoneText?: string;
  ctaText?: string;
  ctaHref?: string;
}

export interface Props extends Omit<BaseProps, 'bodyClass'> {
  /** Header configuration (or use header slot) */
  header?: HeaderConfig;

  /** Footer configuration (or use footer slot) */
  footer?: FooterConfig;

  /** Mobile menu configuration (or use mobile-menu slot) */
  mobileMenu?: MobileMenuConfig;

  /** Mobile CTA bar configuration (or use mobile-cta slot) */
  mobileCta?: MobileCtaConfig;

  /** Main content ID for skip link */
  mainContentId?: string;
}

const {
  header,
  footer,
  mobileMenu,
  mobileCta,
  mainContentId = 'main-content',
  ...baseProps
} = Astro.props;

// Check for component slots
const hasHeaderSlot = Astro.slots.has('header');
const hasFooterSlot = Astro.slots.has('footer');
const hasMobileMenuSlot = Astro.slots.has('mobile-menu');
const hasMobileCtaSlot = Astro.slots.has('mobile-cta');
---

<BaseLayout {...baseProps} bodyClass="min-h-screen flex flex-col">
  <slot name="head" slot="head" />

  <!-- Header -->
  {hasHeaderSlot ? (
    <slot name="header" />
  ) : header && (
    <header
      class="fixed top-0 left-0 right-0 z-50 bg-white shadow-sm transition-transform duration-300 ease-out"
      id="main-header"
    >
      <div class="container mx-auto px-4">
        <div class="flex items-center justify-between h-16 md:h-20">
          <a href="/" class="flex-shrink-0">
            <img
              src={header.logo.src}
              alt={header.logo.alt}
              width={header.logo.width || 120}
              height={header.logo.height || 40}
              class="h-8 md:h-10 w-auto"
            />
          </a>

          {header.navItems && header.navItems.length > 0 && (
            <nav class="hidden lg:flex items-center gap-6" aria-label="Fő navigáció">
              {header.navItems.map((item) => (
                <a
                  href={item.href}
                  class="text-gray-700 hover:text-primary-600 transition-colors font-medium"
                >
                  {item.label}
                </a>
              ))}
            </nav>
          )}

          <div class="hidden md:flex items-center gap-4">
            <a
              href={`tel:${header.phone.replace(/\s/g, '')}`}
              class="text-primary-600 font-semibold hover:text-primary-700 transition-colors"
            >
              {header.phone}
            </a>
            <a
              href={header.ctaHref}
              class="inline-flex items-center justify-center px-5 py-2.5 bg-primary-600 text-white font-semibold rounded-lg hover:bg-primary-700 transition-colors"
            >
              {header.ctaText}
            </a>
          </div>

          <button
            type="button"
            class="md:hidden p-2 -mr-2 text-gray-700"
            aria-expanded="false"
            aria-controls="mobile-menu"
            aria-label="Menü megnyitása"
            id="mobile-menu-button"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
    </header>
  )}

  <!-- Header Spacer -->
  <div class="h-16 md:h-20" aria-hidden="true"></div>

  <!-- Main Content -->
  <main id={mainContentId} class="flex-1">
    <slot />
  </main>

  <!-- Footer -->
  {hasFooterSlot ? (
    <slot name="footer" />
  ) : footer && (
    <footer class="bg-gray-900 text-gray-300 pb-24 md:pb-12">
      <div class="container mx-auto px-4 pt-12 md:pt-16">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">
          <div>
            <h3 class="text-white font-bold text-lg mb-4">{footer.companyName}</h3>
            {footer.companyInfo && (
              <p class="text-gray-400 mb-4 text-sm">{footer.companyInfo}</p>
            )}
            <ul class="space-y-2 text-sm">
              {footer.address && <li>{footer.address}</li>}
              {footer.phone && (
                <li>
                  <a href={`tel:${footer.phone.replace(/\s/g, '')}`} class="hover:text-white">
                    {footer.phone}
                  </a>
                </li>
              )}
              {footer.email && (
                <li>
                  <a href={`mailto:${footer.email}`} class="hover:text-white">
                    {footer.email}
                  </a>
                </li>
              )}
            </ul>
          </div>

          {footer.columns?.map((column) => (
            <div>
              <h3 class="text-white font-semibold mb-4">{column.title}</h3>
              <ul class="space-y-2">
                {column.links.map((link) => (
                  <li>
                    <a href={link.href} class="text-sm text-gray-400 hover:text-white">
                      {link.label}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </div>

        <div class="mt-12 pt-8 border-t border-gray-800 text-sm text-gray-500">
          <p>© {new Date().getFullYear()} {footer.companyName}. Minden jog fenntartva.</p>
        </div>
      </div>
    </footer>
  )}

  <!-- Mobile Menu -->
  {hasMobileMenuSlot ? (
    <slot name="mobile-menu" />
  ) : mobileMenu && (
    <div
      id="mobile-menu"
      class="fixed inset-0 z-[60] bg-white transform translate-x-full transition-transform duration-300 ease-out md:hidden"
      aria-hidden="true"
    >
      <!-- Mobile menu content would go here -->
    </div>
  )}

  <!-- Mobile CTA Bar -->
  {hasMobileCtaSlot ? (
    <slot name="mobile-cta" />
  ) : mobileCta && (
    <div class="fixed bottom-0 left-0 right-0 z-50 md:hidden bg-white border-t border-gray-200 shadow-lg pb-[env(safe-area-inset-bottom)]">
      <div class="grid grid-cols-2 divide-x divide-gray-200">
        <a
          href={`tel:${mobileCta.phone.replace(/\s/g, '')}`}
          class="flex items-center justify-center gap-2 py-4 text-primary-600 font-semibold"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          {mobileCta.phoneText || 'Hívjon most'}
        </a>
        <a
          href={mobileCta.ctaHref || '#contact'}
          class="flex items-center justify-center gap-2 py-4 bg-primary-600 text-white font-semibold"
        >
          {mobileCta.ctaText || 'Árkalkulátor'}
        </a>
      </div>
    </div>
  )}

  <slot name="body-end" slot="body-end" />
</BaseLayout>
